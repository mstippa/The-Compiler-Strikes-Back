<html>
<head>
<script src="lexer.js" type="text/javascript"></script>
<script src="parser.js" type="text/javascript"></script>		
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="style.css">
</head>
<body>
	<h1>The Compiler that Struck Back</h1>
	<div id="body" class="container">
		<div class="row">
			<button type="button" class="dropbtn btn btn-primary col-md-3 col-md-offset-3" id="compile" onclick="compileBtnClick();">Compile</button>
			<div class="dropdown">
				<button type="button" class="dropbtn btn btn-primary" onclick="displayDropdown()">Test Cases</button>
				<div id="myDropdown" class="dropdown-content">
					<a href="#test1" onclick="testCases(1)">Test 1</a>
					<a href="#test2" onclick="testCases(2)">Test 2</a>
					<a href="#test3" onclick="testCases(3)">Test 3</a>
					<a href="#test4" onclick="testCases(4)">Test 4</a>
				</div>
			</div>	
		</div>
		<div class="row">
			<textarea class="col-md-5 col-md-offset-1 inputOutput" id="sourceCode" placeholder="Intput your code here. It better be right!"></textarea>
			<div id="output" class="col-md-5 inputOutput"></div>
		</div>
		<div class="row">
			<textarea id="tree" class="col-md-4 col-md-offset-4"></textarea>			
		</div>
	<script type="text/javascript">

		function compileBtnClick() {
			init();
			input = document.getElementById('sourceCode').value; // get the source file
			input = input.replace(/^\s+|\s+$/g, ""); // this removes the leading and trailing spaces
			findTokens();
			displayTokens();
			parsePrograms();
		}

		function parsePrograms() {
			var i = 0;
			while (i < programCounter) {
				parse();
				i++;
			}
		}

		// clears output box and resets global variables
		function init() {
			possibleKeyword = "";
			currentToken = "";
			index = 0;
			input = "";
			tokenName = "";
			lineCounter = 1;
			tokens = [];
			quoteCounter = 0;
			programCounter = 0;
			parseIndex = 0;
			currentTokenValue = "";
			nextTokenValue = "";
			eofCounter = 0;
			parseErrors = [];
			errorCounter = 0;
			tree = new Tree();
			document.getElementById("output").innerHTML = "";
			document.getElementById("tree").innerHTML = "";
		}


		// displays the dropdown menu and fills the input box with a test case
		function displayDropdown() {
			document.getElementById("myDropdown").classList.toggle("show");	 
		}

		// closes the dropdown menu when user clicks window
		window.onclick = function(event) {
		  if (!event.target.matches(".dropbtn")) {
		    var dropdowns = document.getElementsByClassName("dropdown-content");
		    var i;
		    for (i = 0; i < dropdowns.length; i++) {
		      var openDropdown = dropdowns[i];
		      if (openDropdown.classList.contains("show")) {
		        openDropdown.classList.remove("show");
		      }
		    }
		  }
		}

		// displays the test cases in the sourceCode box
		function testCases(test) {
			if (test === 1) {
				document.getElementById("sourceCode").value = "{}$\n{{{{{}}}}}$\n{{{{}}}}}$\n{int @}$";
			} else if (test === 2) {
				document.getElementById("sourceCode").value = 'inta a1 != == string b\n(}})("if"';
			} else if (test === 3) {
				document.getElementById("sourceCode").value = '{\n   print() boolean a\n)$true false';
			} else if (test ===4) {
				document.getElementById("sourceCode").value = '{print("inta")}$\n{"$"}$\n{"two\nlines"}$';
			} 
		}
	</script>	
</body>
</html>
